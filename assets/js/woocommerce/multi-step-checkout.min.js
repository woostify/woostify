"use strict";var woostifyValidateEmail=function(e){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e).toLowerCase())},woostifyExpandOrderReview=function(){var e=document.querySelector(".has-multi-step-checkout"),t=document.querySelector("form.woocommerce-checkout"),o=!!t&&t.querySelector(".woostify-before-order-review"),i=1;e&&o&&(o.onclick=function(){1===i?(t.classList.add("expanded-order-review"),i=2):(t.classList.remove("expanded-order-review"),i=1)})},woostifyMultiStepCheckout=function(){var e=document.querySelector(".has-multi-step-checkout"),t=document.querySelector(".multi-step-checkout");if(e&&t){var o=t.querySelectorAll(".multi-step-item"),i=document.querySelector("form.woocommerce-checkout");if(o.length&&i){document.querySelector(".woocommerce-form-coupon-toggle"),i.querySelector("#shipping_method");var r=i.querySelector(".cart-subtotal"),c=i.querySelector(".multi-step-checkout-wrapper"),n=(i.querySelector('.multi-step-checkout-content[data-step="first"]'),i.querySelector('.multi-step-checkout-content[data-step="second"]')),l=(i.querySelector('.multi-step-checkout-content[data-step="last"]'),i.querySelector(".multi-step-checkout-button-wrapper")),d=(i.querySelectorAll(".woocommerce-billing-fields__field-wrapper .validate-required"),l?l.querySelectorAll(".multi-step-checkout-button"):[]),a=!!l&&l.querySelector('.multi-step-checkout-button[data-action="continue"]'),u=a?a.getAttribute("data-continue"):"";d.length&&d.forEach((function(e){e.onclick=function(){var o=e.getAttribute("data-action"),i=t.querySelector(".multi-step-item.active"),r=!!i&&i.previousElementSibling,c=!!i&&i.nextElementSibling;"back"==o&&r&&r.click(),"continue"==o&&c&&c.click(),jQuery("html, body").animate({scrollTop:jQuery(t).offset().top},300)}}));var s=function(e){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(t.length){var o=function(e,t){var o=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=arguments.length>0&&void 0!==arguments[1]&&arguments[1],r=o?o.value.trim():"";i&&(r?"email"==o.type?woostifyValidateEmail(r)?i.classList.remove("field-required"):i.classList.add("field-required"):i.classList.remove("field-required"):i.classList.add("field-required"))};t.forEach((function(e){var t=e.querySelector("[name]");t&&t.addEventListener("input",(function(){o(t,e)}))}))}},m=function(e){var t=i.querySelectorAll(".woocommerce-billing-fields__field-wrapper .validate-required"),o=document.getElementById("ship-to-different-address-checkbox"),r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(r||s(t),o&&(t=o.checked?i.querySelectorAll(".woocommerce-billing-fields__field-wrapper .validate-required, .woocommerce-shipping-fields__field-wrapper .validate-required"):i.querySelectorAll(".woocommerce-billing-fields__field-wrapper .validate-required"),o.addEventListener("change",(function(){t=this.checked?i.querySelectorAll(".woocommerce-billing-fields__field-wrapper .validate-required, .woocommerce-shipping-fields__field-wrapper .validate-required"):i.querySelectorAll(".woocommerce-billing-fields__field-wrapper .validate-required"),r||s(t)}))),r)return t};m(),o.forEach((function(e,t){e.onclick=function(){var i=e.nextElementSibling,r=i?i.innerText:"",l=!1,d=m(!0);if(d.length&&d.forEach((function(e){var t=e.querySelector("[name]");if(t){var o=t.value.trim();if(!o)return l=!0,void e.classList.add("field-required");if("email"==t.type){if(!woostifyValidateEmail(o))return l=!0,void e.classList.add("field-required");e.classList.remove("field-required")}else e.classList.remove("field-required")}})),l)document.getElementById("place_order")&&document.getElementById("place_order").click();else{var s=document.querySelector(".woocommerce-NoticeGroup");s&&(s.style.display="none"),a&&(a.innerHTML=u+" "+r);var p=siblings(e);e.classList.add("active"),p.length&&p.forEach((function(e){e.classList.remove("active")}));var h=document.querySelectorAll(".multi-step-review-information"),v=document.getElementById("billing_email"),y=v?v.value.trim():"",g=document.getElementById("billing_address_1"),q=document.getElementById("billing_address_2"),w=document.getElementById("billing_city"),_=!(!w||"select-one"!==w.type)&&w.querySelector('option[value="'+w.value+'"]'),S=document.getElementById("billing_country"),k=document.getElementById("billing_state"),b=!!k&&k.querySelector('option[value="'+k.value+'"]'),L=!!S&&S.querySelector('option[value="'+S.value+'"]'),E=document.getElementById("ship-to-different-address-checkbox"),T=document.getElementById("shipping_address_1"),x=document.getElementById("shipping_address_2"),A=document.getElementById("shipping_city"),M=document.getElementById("shipping_state"),H=document.getElementById("shipping_country"),B=!!M&&H.querySelector('option[value="'+M.value+'"]'),I=!!H&&H.querySelector('option[value="'+H.value+'"]'),j=document.querySelector('#shipping_method .shipping_method[checked="checked"]')||document.querySelector('#shipping_method .shipping_method[data-index="0"]'),C=!!j&&j.id,O=!!C&&document.querySelector('#shipping_method label[for="'+C+'"]'),Q="",V="",z="";Q+=g?g.value.trim():"",Q+=q?" "+q.value.trim():"",Q+=_?", "+_.innerText.trim():w?", "+w.value.trim():"",Q+=b?", "+b.innerText.trim():"",Q+=L?", "+L.innerText.trim():"",z=Q,E&&E.checked&&(V+=T?T.value.trim():"",V+=x?" "+x.value.trim():"",V+=A?", "+A.value.trim():"",V+=B?", "+B.innerText.trim():"",V+=I?", "+I.innerText.trim():"",z=V),h.length&&h.forEach((function(e){var t=e.querySelector('.multi-step-review-information-row[data-type="email"] .review-information-content'),o=e.querySelector('.multi-step-review-information-row[data-type="address"] .review-information-content'),i=e.querySelector('.multi-step-review-information-row[data-type="shipping"] .review-information-content');t&&(t.innerHTML=y),o&&(o.innerHTML=z),i&&O&&(i.innerHTML=O.innerHTML)})),function(){if(n){var e=document.querySelectorAll("#shipping_method .shipping_method"),t="";if(e.length)if(c.classList.remove("no-shipping-available"),1===e.length){var o=document.querySelector("#shipping_method .shipping_method + label");o&&(t+='<div class="shipping-methods-modified-item">',t+='<label class="shipping-methods-modified-label"><span>'+o.innerHTML+"</span></label>",t+="</div>")}else e.forEach((function(e,o){var i="checked"==e.getAttribute("checked")?'checked="checked"':"",r=e.nextElementSibling;t+='<div class="shipping-methods-modified-item">',t+='<label class="shipping-methods-modified-label" for="shipping-methods-index-'+o+'"><input type="radio" '+i+' name="shipping-method-modified[0]" id="shipping-methods-index-'+o+'" class="shipping-methods-modified-input" value="'+e.value+'"><span>'+r.innerHTML+"</span></label>",t+="</div>"}));else c.classList.add("no-shipping-available");document.querySelector(".shipping-methods-modified")?document.querySelector(".shipping-methods-modified").innerHTML=t:n.insertAdjacentHTML("beforeend",'<div class="shipping-methods-modified">'+t+"</div>");var i=document.querySelectorAll(".shipping-methods-modified-input");i.length&&i.forEach((function(e,t){e.checked&&e.value.includes("local_pickup")&&c.classList.add("has-local-pickup"),e.onclick=function(){var o=t+1,i=document.querySelector("#shipping_method li:nth-of-type("+o+') input[type="radio"]');i&&i.click(),e.value.includes("local_pickup")?c.classList.add("has-local-pickup"):c.classList.remove("has-local-pickup")}}))}}();var R=document.querySelectorAll(".review-information-link");R.length&&R.forEach((function(e){e.onclick=function(){var t=e.closest(".multi-step-review-information-row"),i=!!t&&t.getAttribute("data-type");if(i)switch(i){default:case"email":o[0].click(),v&&v.focus();break;case"address":o[0].click(),E&&E.checked&&T?T.focus():g&&g.focus();break;case"shipping":o[1].click()}}}));var Z=t+1,D=c.querySelector(".multi-step-checkout-content.active"),G=c.querySelector(".multi-step-checkout-content:nth-of-type("+Z+")");D&&D.classList.remove("active"),G&&G.classList.add("active");var N=0==t,$=Z==o.length;if(c.classList.remove("first","last"),N){c.classList.add("first");var F=document.querySelector(".woostify-before-order-review .woostify-before-order-review-total-price strong");F&&(F.innerText=woostify_multi_step_checkout.content_total)}else $&&c.classList.add("last");0==t?(f(),window.updateOrderState=!1):jQuery(document.body).trigger("update_checkout")}}}));var p=function(){var e="";return e+='<tr class="shipping-placeholder">',e+="<th>"+woostify_woocommerce_general.shipping_text+"</th>",e+="<td>"+woostify_woocommerce_general.shipping_next+"</td>",e+="</tr>"},f=function(){if(r){var e=document.querySelector(".order-total td"),t=document.querySelector(".woostify-before-order-review-total-price strong"),o=p();!document.querySelector(".shipping-placeholder")&&document.querySelector("form.woocommerce-checkout .cart-subtotal")&&document.querySelector("form.woocommerce-checkout .cart-subtotal").insertAdjacentHTML("afterend",o),void 0!==woostify_multi_step_checkout.content_total&&(e&&(e.innerHTML=woostify_multi_step_checkout.content_total),t&&(t.innerHTML=woostify_multi_step_checkout.content_total))}};f(),jQuery(document.body).on("updated_checkout",(function(e,t){var o=p();document.querySelector("form.woocommerce-checkout .cart-subtotal")&&!document.querySelector(".shipping-placeholder")&&document.querySelector("form.woocommerce-checkout .cart-subtotal").insertAdjacentHTML("afterend",o),console.log(t);var i=document.querySelector(".multi-step-checkout-wrapper.first"),r=document.querySelector(".woocommerce-checkout-review-order-table");if(i){var c=document.querySelector(".order-total td"),n=document.querySelector(".woostify-before-order-review-total-price strong");c&&(c.innerHTML=t.fragments._first_step_price),n&&(n.innerHTML=t.fragments._first_step_price)}else{r&&(r.innerHTML=t.fragments[".woocommerce-checkout-review-order-table"]);var l=document.querySelector(".order-total td"),d=document.querySelector(".woostify-before-order-review-total-price strong");l&&d&&(d.innerHTML=l.innerText)}}))}}};document.addEventListener("DOMContentLoaded",(function(){woostifyMultiStepCheckout(),woostifyExpandOrderReview()}));